# ============================================================================
# Momentum - Environment Variables for All Microservices
# ============================================================================
#
# RECOMMENDED: Auto-generate all secrets with one command:
#   ./scripts/generate-secrets.sh
#
# Manual setup (copy this file to .env and fill in values):
#   cp .env.example .env
#
# NEVER commit .env to version control!
# ============================================================================

# ----------------------------------------------------------------------------
# General Configuration
# ----------------------------------------------------------------------------
NODE_ENV=production
ENV=production
LOG_LEVEL=INFO

# ----------------------------------------------------------------------------
# Database Configuration (Neon Serverless PostgreSQL)
# ----------------------------------------------------------------------------
# REQUIRED: Neon PostgreSQL connection strings
# Get your connection string from: https://console.neon.tech

# For Python services (backend, ai-agent) - SQLAlchemy async format with asyncpg
# NOTE: asyncpg uses 'ssl=require' NOT 'sslmode=require' (different from psycopg2/Prisma)
DATABASE_URL=postgresql+asyncpg://user:pass@ep-xxx.region.aws.neon.tech/dbname?ssl=require

# For auth-server (Prisma/Node.js) - Standard PostgreSQL format
# NOTE: Prisma uses 'sslmode=require' (standard PostgreSQL format)
PRISMA_DATABASE_URL=postgresql://user:pass@ep-xxx.region.aws.neon.tech/dbname?sslmode=require

# ----------------------------------------------------------------------------
# Authentication & Security Secrets
# ----------------------------------------------------------------------------
# Generate with: openssl rand -base64 32

# better-auth secret (32+ characters)
BETTER_AUTH_SECRET=change-this-to-secure-random-32-char-secret

# JWT secret (shared between auth-server and backend)
JWT_SECRET=change-this-to-different-jwt-secret-key

# JWT configuration
JWT_ALGORITHM=HS256
JWT_EXPIRES_IN=7d

# Service-to-service authentication token
SERVICE_AUTH_TOKEN=change-this-service-auth-token

# API key encryption (Fernet key for backend API key storage)
# Generate with: python3 -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
ENCRYPTION_KEY=change-this-fernet-encryption-key

# ----------------------------------------------------------------------------
# URLs & CORS Configuration
# ----------------------------------------------------------------------------
# Auth server public URL
BETTER_AUTH_URL=http://localhost:3002

# Frontend URL (for CORS)
FRONTEND_URL=http://localhost:3000

# CORS origins (comma-separated, no spaces)
CORS_ORIGINS=http://localhost:3000

# ----------------------------------------------------------------------------
# Email Configuration (Resend)
# ----------------------------------------------------------------------------
# Get API key from: https://resend.com/api-keys
RESEND_API_KEY=re_your_resend_api_key_here

# Sender email (must be verified in Resend dashboard)
EMAIL_FROM=noreply@momentum.intevia.cc

# ----------------------------------------------------------------------------
# AI Agent Configuration (Gemini 2.5 Flash)
# ----------------------------------------------------------------------------
# Get API key from: https://aistudio.google.com/app/apikey
AGENT_GEMINI_API_KEY=your_gemini_api_key_here

# Optional: OpenAI API key for tracing/monitoring
AGENT_OPENAI_API_KEY=

# Agent behavior settings
AGENT_TEMPERATURE=0.7
AGENT_TOKEN_BUDGET=800000
AGENT_ENCODING_NAME=cl100k_base
AGENT_MCP_TIMEOUT=10
AGENT_MCP_RETRY_ATTEMPTS=3

# ----------------------------------------------------------------------------
# MCP Server Configuration
# ----------------------------------------------------------------------------
MCP_LOG_LEVEL=INFO
BACKEND_TIMEOUT=30.0
BACKEND_MAX_RETRIES=2

# ----------------------------------------------------------------------------
# Frontend Public Environment Variables (Build-time)
# ----------------------------------------------------------------------------
# These are embedded into the Next.js bundle at build time
NEXT_PUBLIC_AUTH_URL=http://localhost:3002/api/auth
NEXT_PUBLIC_API_URL=http://localhost:8000
NEXT_PUBLIC_AI_AGENT_URL=http://localhost:8002
NEXT_PUBLIC_DOMAIN_KEY=local-dev
NEXT_PUBLIC_GA_MEASUREMENT_ID=

# ============================================================================
# Quick Start Instructions
# ============================================================================
#
# 1. Copy this file:
#    cp .env.example .env
#
# 2. Generate secure secrets:
#    openssl rand -base64 32
#
# 3. Fill in required values:
#    - DATABASE_URL (from Neon console: https://console.neon.tech)
#    - BETTER_AUTH_SECRET (generate new secret)
#    - JWT_SECRET (generate different secret)
#    - SERVICE_AUTH_TOKEN (generate another secret)
#    - ENCRYPTION_KEY (generate Fernet key)
#    - RESEND_API_KEY (from resend.com)
#    - AGENT_GEMINI_API_KEY (from Google AI Studio)
#
# 4. Start all services:
#    docker-compose up --build
#
# 5. Access services:
#    - Frontend: http://localhost:3000
#    - Auth Server: http://localhost:3002
#    - Backend API: http://localhost:8000
#    - MCP Server: http://localhost:8001
#    - AI Agent: http://localhost:8002
#    - Database: Neon serverless PostgreSQL (cloud-hosted)
#
# ============================================================================
